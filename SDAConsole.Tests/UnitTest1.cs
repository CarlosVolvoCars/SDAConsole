using Moq;
using DAL.Shared.Models;
using Microsoft.Extensions.Logging;
using SDAConsole.types;
using System.Text.Json;

[TestFixture]
public class ExtractVinFromResponseTest()
{
    private Mock<ILogger> _mockLogger;

    private Mock<InstallationReport> _mockInstallationReport;

    private Mock<DalConfiguration> _mockDalConfig;

    [SetUp]
    public void Setup()
    {
        _mockLogger = new Mock<ILogger>();
        _mockInstallationReport = new Mock<InstallationReport>();
        _mockDalConfig = new Mock<DalConfiguration>();
    }

    [Test]
    public void ExtractVin_ShouldReturnCorrectVin()
    {
        // Instatiate the InstallationReportParser (Class from SDAConsole Program.cs)
        var parser = new InstallationReportParser(_mockInstallationReport.Object, _mockDalConfig.Object, _mockLogger.Object);

        // Arrange
        var jsonResponse = "62F1140000595634544545454231544D3939393035313836313238353038383939393035313335363939323032353231323032352D30352D31395430303A30303A30302E3030305A323032342D31312D32395431303A31373A31302E3736355A303030303030303030303030303030303030303130302E30302E3030303333313731363232000030313100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
        var expectedVin = "YV4TEEEB1TM999051";

        // Act
        var result = parser.ExtractVinFromResponse(jsonResponse);

        // Assert
        Assert.That(result, Is.EqualTo(expectedVin));

    }
}

[TestFixture]
public class ExtractFyonFromResponseTest()
{
    private Mock<ILogger> _mockLogger;

    private Mock<InstallationReport> _mockInstallationReport;

    private Mock<DalConfiguration> _mockDalConfig;

    [SetUp]
    public void Setup()
    {
        _mockLogger = new Mock<ILogger>();
        _mockInstallationReport = new Mock<InstallationReport>();
        _mockDalConfig = new Mock<DalConfiguration>();
    }

    [Test]

    public void ExtractFyon_ShouldReturnCorrectFyon()
    {
        // Instatiate the InstallationReportParser (Class from SDAConsole Program.cs)
        var parser = new InstallationReportParser(_mockInstallationReport.Object, _mockDalConfig.Object, _mockLogger.Object);

        // Arrange
        var jsonResponse = "62F1140000595634544545454231544D3939393035313836313238353038383939393035313335363939323032353231323032352D30352D31395430303A30303A30302E3030305A323032342D31312D32395431303A31373A31302E3736355A303030303030303030303030303030303030303130302E30302E3030303333313731363232000030313100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
        var expectedFyon = "861285088";

        // Act
        var result = parser.ExtractFYONFromResponse(jsonResponse);
        // Assert
        Assert.That(result, Is.EqualTo(expectedFyon));
    }
}

[TestFixture]
public class ExtractChassisFromResponseTest()
{
    private Mock<ILogger> _mockLogger;

    private Mock<InstallationReport> _mockInstallationReport;

    private Mock<DalConfiguration> _mockDalConfig;

    [SetUp]
    public void Setup()
    {
        _mockLogger = new Mock<ILogger>();
        _mockInstallationReport = new Mock<InstallationReport>();
        _mockDalConfig = new Mock<DalConfiguration>();
    }

    [Test]
    public void ExtractChassis_ShouldReturnCorrectChassis()
    {
        // Instatiate the InstallationReportParser (Class from SDAConsole Program.cs)
        var parser = new InstallationReportParser(_mockInstallationReport.Object, _mockDalConfig.Object, _mockLogger.Object);

        // Arrange
        var jsonResponse = "62F1140000595634544545454231544D3939393035313836313238353038383939393035313335363939323032353231323032352D30352D31395430303A30303A30302E3030305A323032342D31312D32395431303A31373A31302E3736355A303030303030303030303030303030303030303130302E30302E3030303333313731363232000030313100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
        var expectedChassis = "999051";

        // Act
        var result = parser.ExtractChassisFromResponse(jsonResponse);
        // Assert
        Assert.That(result, Is.EqualTo(expectedChassis));
    }
}

[TestFixture]
public class ExtractFactoryCodeFromResponseTest()
{
    private Mock<ILogger> _mockLogger;

    private Mock<InstallationReport> _mockInstallationReport;

    private Mock<DalConfiguration> _mockDalConfig;

    [SetUp]
    public void Setup()
    {
        _mockLogger = new Mock<ILogger>();
        _mockInstallationReport = new Mock<InstallationReport>();
        _mockDalConfig = new Mock<DalConfiguration>();
    }

    [Test]
    public void ExtractFactoryCode_ShouldReturnCorrectFactoryCode()
    {
        // Instatiate the InstallationReportParser (Class from SDAConsole Program.cs)
        var parser = new InstallationReportParser(_mockInstallationReport.Object, _mockDalConfig.Object, _mockLogger.Object);

        // Arrange
        var jsonResponse = "62F1140000595634544545454231544D3939393035313836313238353038383939393035313335363939323032353231323032352D30352D31395430303A30303A30302E3030305A323032342D31312D32395431303A31373A31302E3736355A303030303030303030303030303030303030303130302E30302E3030303333313731363232000030313100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
        var expectedFactoryCode = "99";

        // Act
        var result = parser.ExtractFactoryCodeFromResponse(jsonResponse);
        // Assert
        Assert.That(result, Is.EqualTo(expectedFactoryCode));
    }
}

[TestFixture]
public class ExtractStructureWeekFromResponseTest()
{
    private Mock<ILogger> _mockLogger;

    private Mock<InstallationReport> _mockInstallationReport;

    private Mock<DalConfiguration> _mockDalConfig;

    [SetUp]
    public void Setup()
    {
        _mockLogger = new Mock<ILogger>();
        _mockInstallationReport = new Mock<InstallationReport>();
        _mockDalConfig = new Mock<DalConfiguration>();
    }

    [Test]
    public void ExtractStructureWeek_ShouldReturnCorrectStructureWeek()
    {
        // Instatiate the InstallationReportParser (Class from SDAConsole Program.cs)
        var parser = new InstallationReportParser(_mockInstallationReport.Object, _mockDalConfig.Object, _mockLogger.Object);

        // Arrange
        var jsonResponse = "62F1140000595634544545454231544D3939393035313836313238353038383939393035313335363939323032353231323032352D30352D31395430303A30303A30302E3030305A323032342D31312D32395431303A31373A31302E3736355A303030303030303030303030303030303030303130302E30302E3030303333313731363232000030313100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
        var expectedStructureWeek = 202521;
        // Act
        var result = parser.ExtractStructureWeekFromResponse(jsonResponse);
        // Assert
        Assert.That(result, Is.EqualTo(expectedStructureWeek));
    }
}

[TestFixture]
public class ExtractCoMoExpresionsFromResponseTest
{
    private Mock<ILogger> _mockLogger;

    private Mock<InstallationReport> _mockInstallationReport;

    private Mock<DalConfiguration> _mockDalConfig;

    private ILogger _logger;

    [SetUp]
    public void Setup()
    {

        using ILoggerFactory factory = LoggerFactory.Create(builder => builder.AddConsole());
        _logger = factory.CreateLogger("Unit Testing");

        _mockLogger = new Mock<ILogger>();
        _mockInstallationReport = new Mock<InstallationReport>();
        _mockDalConfig = new Mock<DalConfiguration>();
    }

    [Test]
    public void ExtractCoMoExpresions_ShouldReturnCorrectCoMoExpresions()
    {
        // Instatiate the InstallationReportParser (Class from SDAConsole Program.cs)
        var parser = new InstallationReportParser(_mockInstallationReport.Object, _mockDalConfig.Object, _mockLogger.Object);

        // Arrange
        var jsonResponse = "62C011000000323532353A4A57452C333231393A3750412C353934303A37424A2C393938373A3455372C3030594C3A4A32472C303347383A3144432C303645543A3142362C303659353A5951512C3037454A3A3843522C3037544C3A4559422C303859573A3838562C303946353A5759362C304346363A4444342C304458533A4350422C304551443A35464D2C304634353A4C555A2C304842413A3630542C304A32443A48454C2C304B56493A53524A2C304C47593A4842552C304E4F563A3145532C305154553A414A542C305437433A3348442C3058505A3A3358392C305A444D3A594C482C313151313A4142352C3132414F3A3434352C3137304B3A484C582C314644453A4942302C314930583A5A5A592C315053453A4359432C315154593A45305A2C31524A493A5545582C315448563A4A55452C3156394D3A4555452C315741583A525A472C32304B553A3735362C323230413A34344D2C323249463A3241462C323346443A4C55542C32354F593A504A4B2C323850593A4435522C324358353A4936322C32474C553A3745522C3248575A3A5947342C324B55463A5134532C324D46463A4F35482C324D55583A3049522C324D55583A3158502C324D55583A3235562C324D55583A33554C2C324D55583A3737582C324D55583A3831432C324D55583A4246352C324D55583A44354A2C324D55583A4A36442C324D55583A4B44432C324D55583A4F51302C324D55583A4F5A4E2C324D55583A544C582C324D55583A5533592C324D55583A564B4D2C324D55583A58424F2C324D55583A594B5A2C324E4C463A4143542C325235333A3045572C3256344C3A4C47332C325833473A3155582C3342364E3A5142572C334239373A44464C2C334358433A46474E2C334643333A4D38482C334F48313A4F535A2C335151503A3733322C3352394D3A4456512C33534E463A3454382C335756373A4C30522C33594F523A4B32482C335951353A4E31552C3432325A3A5942352C34324C593A5358322C343254433A4D464D2C343856343A3434372C343856343A3636372C343856343A3644452C343856343A42524C2C343856343A454E342C343856343A4659322C343856343A4855502C343856343A4C4C432C343856343A4D37552C343856343A4E41422C344131313A31484C2C3441354F3A4135542C34434F303A4358492C344858513A4631462C344A4F473A4552532C344B49343A3330452C344E45323A5749492C344E525A3A454D482C345231413A5057472C345654493A3247562C345838393A5A4E382C353245423A41594B2C353649593A4834302C3547594D3A3150452C35484B313A4841422C354B554C3A3658312C354E39343A574C442C354F51443A385A4E2C355037423A5A47332C355143443A4A49472C355153333A31544F2C355350423A3730552C355430393A3638312C355441413A3248342C3555524A3A4D54512C355834523A495A532C355937313A5347352C355941593A55514C2C355A364B3A504A412C363053313A354E332C363246373A4345392C363251453A56475A2C36335A4F3A5530512C363650473A32374A2C363953363A5752452C3639574E3A5952452C36434B513A4C4F4A2C364449383A5553522C364534333A56594E2C364538563A52414F2C364638563A3246452C364734423A324E452C364738413A4E56412C364D364D3A4757492C364D484E3A5631352C364F5A323A4E495A2C365059413A515A4F2C365130443A5538512C365335553A57594A2C365539383A57464E2C365559453A4131592C36564B333A5051582C365830353A565A572C3731324E3A3147552C373652433A3851592C373753363A3432552C373756373A3634512C3741324E3A54484C2C37414A363A45334C2C37494A393A45384A2C374C55413A5A4B412C37514B523A344F492C3752584D3A54334D2C3756494C3A484A582C3757385A3A3252552C383049583A4B43332C383053313A5A334D2C383254373A394D4E2C383254373A5654522C383544533A5941522C38354B513A574E492C3836344B3A5348472C3837474B3A33484E2C383845343A3833442C383847423A4F50542C384357563A584D4F2C3844424A3A3439322C38485A5A3A3450592C3849494D3A3931352C384A33543A5337422C385155343A4B36332C385236593A30384A2C3857524B3A3237492C38584D303A5A58522C39324A493A49454C2C39394A383A5932382C394155453A4B57502C394253383A3452502C394851373A384E4E2C394A4D383A334F562C394C57323A4E55472C394D56593A5141382C395159543A3952532C395633363A3752522C395A32453A4A48442C395A35573A4B43532C413048563A43525A2C41324D433A424E332C413433503A564C542C413547593A3330572C413751463A5130462C414254363A4B46552C4146504D3A595A4B2C414734323A46324F2C415231333A5742552C4155324B3A414B4D2C415758463A3838492C415945543A4A47352C423155583A354D372C423646463A4E36572C424135363A3454372C424433383A3735412C424646573A4E30382C42485A453A4E36582C424A4A413A3142452C424C41483A554C4A2C424F43443A4333542C4252385A3A4357532C425451493A57554F2C425556583A454B422C43314A483A375A572C433247343A47594C2C4334494C3A4332432C433535323A5644422C433552563A4839572C433655422E312E4335354C3A4354482C433655422E322E4335354C3A4354482C433747433A44384A2C433750313A4D41532C43394C373A4B56372C434946343A5A4E562C434B30333A5339312C434C4B393A4359452C435131463A4D41332C435253323A4656472C443248453A554A572C443355393A4A36352C443658563A5948522C443935483A544F482C44395A503A4F38542C44414C313A5152392C4442534E3A4847352C444A34413A4B57372C444C58463A5255542C444F31473A5359342C4451314B3A5657442C4457304C3A4D48422C453343553A484E4D2C45375A4E3A33314B2C454752393A4A324B2C454759503A3047512C454846483A30324D2C45494E443A364C4C2C454C35483A5A36512C454C49513A5957572C454F47483A4D56322C45514A463A454B572C455732373A4D31572C463135383A4B56522C463154503A4746452C463231333A594B502C463341543A4B53412C463652363A4A4F592C46434D573A5353472C46434F493A3238482C464949543A57454C2C464D56393A3456522C464F31393A5835302C465755333A3635332C4659474B3A3253502C473333533A5259542C47334F393A554C462C473832583A4455342C474148533A4F504B2C47434B443A524B512C474355543A4832392C4744514C3A344F442C474941313A545A372C474D39473A3945482C475248363A41594F2C4753534D3A3145532C475543513A3551502C475631383A5A4D552C475932323A5836322C483135393A4F48342C48324B493A4856452C4835344A3A54314F2C483651333A3236512C4842304F3A4D43502C484251523A4130312C484447383A4236312C484538503A4C43302C484543583A5239352C484548593A3356312C484730583A36414F2C484730583A4538502C484752543A4B53552C484755593A5044522C484843593A5257472C484849453A55334B2C484A4F443A4C39332C484B45443A4A34442C484C4B563A53424A2C485059333A4149442C485751593A5755322C485A42353A3943362C493054503A4957412C493259383A4B525A2C4933474F3A43554B2C493435463A4C324E2C4936314C3A3544352C493739453A585A322C493742473A4445572C4939314A3A47315A2C494836503A4857592C494944333A454B512C494A38303A504C432C494A4B523A3437352C494C4B5A3A4A57332C49504A4D3A30414A2C49524D573A5143412C495948583A4B304B2C495A39373A4450502C4A3044343A4535482C4A3639323A4656372C4A364A553A5047502C4A3744563A5958462C4A3757473A4557542C4A3941393A5959432C4A39444B3A49445A2C4A4259473A47494A2C4A4558593A4C56482C4A4834413A4E33302C4A49424E3A414C482C4A4A57313A5A46532C4A4D4A393A4E354E2C4A4E39373A4448542C4A5256543A345A392C4A53594B3A5230522C4A5548593A5742332C4B30584C3A4337582C4B3548513A4334372C4B3732393A4D52472C4B3844473A4E50462C4B4530563A374B552C4B4D304B3A4D38432C4B5930593A46494C2C4B5933573A4D5A422C4B5939453A305A4C2C4C304E393A584E372C4C31484F3A32344F2C4C3339463A414F4B2C4C34504B3A5047322C4C37314B3A3550512C4C3759453A4C38372C4C4250333A5346362C4C464B553A3636312C4C4659313A5051512C4C494D363A3935332C4C5037493A4A364B2C4C514A573A454B392C4C5247563A4444322C4C5344533A4651362C4C5444593A4858472C4C58414D3A4646372C4C5A36433A3559482C4D304F323A58384C2C4D36594C3A52364E2C4D4131413A42564F2C4D4137503A4836562C4D4248503A54414F2C4D4437313A3339462C4D4932593A5134472C4D4938513A4647332C4D4B45333A5955552C4D4B4B583A5156422C4D4D34523A574B4D2C4D4F35443A4836432C4D4F434A3A33424A2C4D5333323A4B58372C4D5635503A4A55562C4D5732533A3149332C4D5A59393A4730442C4E3058423A5831582C4E3347563A36595A2C4E35394A3A525A492C4E39334B3A5439432C4E4850503A5856512C4E4957453A5759482C4E4D4B4A3A3757552C4E4D574C3A4557412C4E5032393A5148462C4E585A4B3A3856482C4F3548333A3243412C4F364A383A3658362C4F42334E3A5449502C4F424C383A41324E2C4F4533313A4A44382C4F4632573A5134352C4F4741433A35494F2C4F4D504C3A3747452C4F5454553A3430392C4F5652483A354F4C2C4F5844353A4830422C4F5939303A49504C2C503131513A4B4E442C503231443A4154322C503259423A45474F2C503441423A5A57432C50354D333A514A552C503550423A3250372C503839413A4F59442C504756453A4E46512C50484D393A4437312C504937503A4D344B2C504954553A4352422C50495A503A584B372C504C41363A4153302C504C46443A33414C2C504D44483A4348522C50514E393A3430302C505256333A4C43512C50554B453A4555452C50554C333A4E4D352C50594D593A3843502C513059363A55324F2C513237363A3641362C51374C4E3A4A54312C5138574E3A4B574D2C514357533A3842412C5145574D3A4147372C5149324C3A354B472C514958543A3552562C514A4A373A3051472C514A4D343A3343482C514C30363A3238592C514D36313A4933392C515144523A54534D2C51564B463A4534352C515733543A5454432C515A54533A5453382C523343363A52524B2C523742503A394D4E2C52384C333A5A44332C52394E303A4F4B502C524235483A46574A2C524546313A51464D2C524548493A5335482C5246594E3A3453422C52465A4C3A4E36472C524748583A4F32502C524835313A5A484C2C524942573A5552442C52514C393A3247442C5251554A3A354F412C525752303A36474B2C525853473A43494D2C525A4E343A4452362C53314C523A5A43412C533155383A4330302C5332374C3A4531512C5335354B3A4955542C533745413A41384C2C533937343A4155452C534135543A4737432C534234333A424C382C53424B443A344E532C5343325A3A39574C2C534346543A414E4F2C53454F323A304D442C534739523A564D532C534A364C3A4A50452C534A4B473A4232322C535447503A3331332C535450593A3059332C535532303A4557472C535854463A4D52502C543146433A3744552C543838553A4A50442C544450323A3144342C544742323A584B472C54484E4C3A4733342C545139443A3135392C54534F353A3345342C545351323A4336572C545355533A354A362C5455414B3A4555592C545633483A574F482C545659413A514E552C545853523A3742382C55314E393A3931362C5532334E3A3744552C553857463A5437472C553934393A514D332C554146393A5547392C554245313A4536472C554338563A3243532C554A454C3A5959382C554A50493A4B56522C554B35523A384F522C554B4D333A4C55372C554F58383A3355462C55504F383A3759502C555352433A4A4B4C2C555652573A3936362C555851593A3057492C563358553A5847382C563430593A4C49522C5643544E3A5052522C564545353A554F522C5648304D3A3449392C564841333A5A39552C564933333A4C4D312C5649464C3A4C4C4F2C56494B333A5443592C564A32553A4730502C564C4A383A394C452C564E52553A4D31342C565350473A4C37312C5653594C3A49334E2C565454433A31454E2C565659343A4A37382C56584C553A344F572C565942533A3233462C565A43373A59524A2C573146583A5633572C573253533A5A55342C573346563A5945372C573436433A3942502C573536373A43554D2C573838493A584D4D2C5738384D3A374B582C57424A373A4133502C574251433A48564F2C57434A393A4B4A472C574454433A464D352C574544473A56434A2C5745454A3A46495A2C574B53553A4938472C574D4B353A5048472C574E43413A354C4E2C574E46383A5436432C57514E393A35434B2C5755504A3A4631582C575A4B463A4B454D2C583034433A3850542C58314A5A3A4732472C583446503A3052322C583452553A3637342C583459543A5443312C584257563A5945382C584331433A564B5A2C584456533A3857362C584534523A59545A2C584930423A4F54532C5851564E3A4A33532C585256513A4E33342C5854344A3A35314F2C585549593A5445522C585934473A5242392C59324D433A444D502C593850353A3144462C594551413A5934552C594942543A34365A2C594A31343A4346302C594A4E443A4144352C594F53493A3737312C595658563A5948582C595943493A3035302C595A354F3A3834592C595A4A373A4655442C5A334B543A4A34352C5A3639423A5654562C5A3848503A5852312C5A4246363A464F392C5A4256553A3533522C5A4432533A4349532C5A46494C3A42385A2C5A464A363A544C4E2C5A4839343A454B392C5A484C363A3242452C5A4942383A3952442C5A4F49563A4E51502C5A51305A3A4753342C5A5552373A4543342C5A5745303A454A302C5A59365A3A3433322C393138353A4335302C303039523A3447542C303134383A4A48512C304237353A4D4D332C30434A383A4443542C304447473A4239372C30444D543A3430512C30494E383A34564A2C304C4D583A4534372C304E41453A4441392C305133493A5435372C305247533A33504A2C3057354C3A42504C2C305A5A463A544E542C3134414A3A4841422C3134574C3A4347362C3136304B3A514D492C313859493A4C54372C31424F533A3446352C3146495A3A4451322C314841443A4347592C314E30383A5049342C314E364C3A54545A2C315131453A3834452C315930503A4D36412C3230534D3A3744472C323445523A3344502C323944563A4633422C3248364A3A585A422C324A53533A3632552C325054453A4743302C32554A493A3749492C325646473A4C41352C325858523A484F392C334D35503A394E362C334E49483A5257592C33504F413A4E39512C335751593A47424C2C335832463A3330382C343650393A3738302C343957493A564F4C2C344950343A385A432C345435443A374F4D2C345439513A3235532C345545513A594E432C345639353A4937512C3458444D3A4F534F2C345951323A5157362C353230513A5150562C353852343A5938442C354152563A3453322C35444A543A5246372C354A58523A5742582C354E4B413A4735352C355131313A5331362C355233493A4943522C355637513A46484B2C355642443A3632392C355755593A52464B2C355847433A4F4D412C364544433A32544A2C364635373A534E532C364B46423A3343322C364B53413A5631412C364C45393A5642492C3650564F3A5044562C365535383A4251572C36554E483A4D33592C3656594F3A5653522C365941593A3842552C373549373A5751562C374158333A564B562C37415A483A4F4E342C374557313A4258572C374833373A3653482C374934363A3759432C374A48593A4157342C374F49453A3152582C37525A463A54584A2C37544E463A4C4F582C375536433A5745562C38314D463A4945382C383344593A344A352C383349593A4944582C3835424A3A3050412C383745513A5634592C384B504F3A49525A2C384E31513A4731552C384F59553A4647382C385852573A4633382C385958493A4D55562C393256483A58304B2C393434593A4530302C394B304A3A4351562C395449473A3254492C395653413A46514B2C395658433A3453552C395830593A4F584F2C413951333A32305A2C4141494D2E312E3359594D3A374A382C4141494D2E312E5148514E3A3152512C4141494D2E312E5A49535A3A4245472C4141494D2E322E3359594D3A374A382C4141494D2E322E5148514E3A3152512C4141494D2E322E5A49535A3A4245472C414257543A5249442C414C4A353A4D44572C415249553A5A4B532C4155434C3A3730572C4155594F3A3349572C4231544D3A5445582C423446333A4B4A432C423553553A3133462C424445453A4447332C4244464D3A5339512C424942503A59374C2C424C484F3A574A582C424C4C573A3744362C424D30573A5931512C424E524F3A3344412C424F37363A314D472C424F38483A4733332C424F47503A4B4E5A2C4250414E3A38444B2C425555493A4459442C433558313A3041572C43364D513A514B432C433655422E312E3057474B3A4845512C433655422E312E333545423A4841472C433655422E312E344442433A534D432C433655422E312E4634454C3A33555A2C433655422E312E4A4444533A5552442C433655422E312E4C3333433A4A495A2C433655422E312E4E4457503A4853362C433655422E312E53485A343A35374A2C433655422E312E584636313A5353392C433655422E322E3057474B3A4845512C433655422E322E333545423A4841472C433655422E322E344442433A534D432C433655422E322E4634454C3A33555A2C433655422E322E4A4444533A5552442C433655422E322E4C3333433A4A495A2C433655422E322E4E4457503A4853362C433655422E322E53485A343A35374A2C433655422E322E584636313A5353392C434331593A4341372C434346593A3843302C434839313A5557322C434D44303A555A482C43505A593A59594F2C4351504D3A4855362C435646523A394F302C43574A573A3437442C435A4F4A3A4837592C44334E573A4849512C4444464F3A5A59392C44475A313A585A562C444832593A4152352C445141453A3043502C445247503A4839462C445642583A5430572C445646333A504F432C445843583A3445382C445854543A3936302C445947573A4F52392C445951333A3648572C44595A313A594C4D2C453135333A5048512C4538594F3A3153412C454131523A544D542C454848523A564C322C454849593A4241582C454A46413A4533412C454A51523A5957482C454B41373A564E532C4550484F3A465A512C455055573A5746552C45514B4F3A4849332C45534D4F3A3431592C4554495A3A4547522C455544513A4759372C4556364F3A4231492C455A34393A4D364A2C463739313A50514B2C463756483A5231562C464233303A364E512C464755353A3331322C464832333A4D54352C464A4F363A47424C2C464C374C3A44574D2C46584A353A32414C2C4732484B3A3634532C474746383A4A55322C474B58583A5A34472C474E39503A3948492C4755594A3A3650462C47585A4B3A31394E2C483746563A5535562C484153303A45484C2C484454383A444C5A2C484B38523A4D4F442C484C545A3A314C342C484D564F3A4F55552C484E4E4D3A5441312C484F44373A4A52572C485239323A31474C2C485645543A4844482C493132593A4B56472C493153473A494A382C49354A4F3A4248572C493930333A4934542C4947344D3A4B32512C494A4E4D3A42344B2C494B515A3A464B372C49524F483A5758522C495453523A564B472C495643473A3838502C495742313A364E542C4A3139483A49464C2C4A33314C3A4242452C4A3339433A5A4F312C4A3545353A3846422C4A374A4C3A41344F2C4A374F563A314C332C4A44574A3A57344D2C4A4F504E3A4150562C4A52544F3A4B59372C4A534D463A354D462C4A544B543A584F562C4A5457433A3642572C4A5A47483A584B572C4B344C483A51425A2C4B3537513A54554A2C4B3639523A494F542C4B3932413A4D424B2C4B42504E3A3554452C4B4532543A5546562C4B4941572E312E454C44573A3545332C4B4941572E322E454C44573A3545332C4B4A41483A5837502C4B4B44453A5552582C4B4C44323A5957412C4B50564B3A4E474F2C4B5A45503A394D562C4C4346433A5530532C4C4537533A3455362C4C515A4D3A4757522C4C54304C3A305A4E2C4C56464F3A5A31472C4C5842543A5556552C4C5931433A4433482C4D364A413A324D392C4D4344363A4F4C4A2C4D44574B3A4D39352C4D4832533A3854432C4D4A424D3A3547542C4D5145463A3330582C4D5549563A49335A2C4D564B373A4B4E502C4D59434C3A5933322C4D5948313A3751512C4E3257493A5154562C4E3758303A584D4C2C4E4449363A5557542C4E4941463A5049492C4E4947393A3349352C4E4C50443A4B50382C4E4D33433A3855452C4E55554B3A565A492C4E57474E3A3032452C4F3259363A5943482C4F35464E3A4C574E2C4F3652453A50495A2C4F3738573A324D442C4F3741503A5633502C4F42534D3A434B362C4F45514B3A5854572C4F4E32513A4743422C4F5453433A5634452C4F564E453A3244372C4F5857513A384C412C503244463A42325A2C503430423A4F4C382C503854493A5736592C504433573A364F542C504756483A5752372C504A53533A4344492C504B38563A4244592C504F4B533A45305A2C505052433A5145442C5058524A3A3959552C5133344E3A5943422C5138544E3A3150332C513931363A4945342C5139435A3A384A4B2C514159443A4C45532C514A32373A4D33412C514A4A503A4C45502C514E32363A374F452C515158353A5452462C515331433A4E59492C523035523A385A472C523143483A5653322C5231514D3A4735502C523835473A32475A2C523850543A3748382C52424A523A534F4C2C524643303A5339342C525133363A35574F2C525635373A33584B2C5259514F3A3946562C525A334C3A4849442C525A43413A5835542C533352363A5345452C533736463A4F46372C533944333A3157542C534734433A3448372C534C4A343A4650302C535032383A364E592C535351593A3236382C535359583A3657302C535457353A4E44322C535745413A4B555A2C53575A523A41354E2C53584A483A4E444A2C535A57333A5939502C543531513A4635332C543938463A5655482C54394D473A4359372C544545483A58564B2C544938553A5830512C544E33503A34394B2C545031453A534E582C545241493A4C4D4D2C54524F373A374D362C5454324B3A5135482C545447593A5258362C54544D453A5A44432C553130383A48324A2C55414B353A4A59512C554151563A304A382C554753513A31454C2C554F35593A46435A2C563032413A5441372C56314C363A4439432C563330353A5658592C563350443A5142462C5634354B3A4954392C56344A413A5747352C563659473A5858332C563748333A574E4F2C563852593A48484E2C56394E453A4645302C5642344B3A5046372C564357513A4149522C565558393A4C44532C5656415A3A4133422C56565A533A5054322C565735583A4437392C565743493A4A56342C565753523A3839312C565A56393A3954542C573230363A5151542C5734594A3A5542392C5735464F3A5833482C57364F413A5439482C573834543A334F392C574254303A5851532C57434C573A4947492C574449433A4E51332C574D554C3A5352362C574F4B473A5A41592C575052553A5759322C575138313A5838512C575147453A4A4F462C575357533A365A302C575930483A37425A2C5830374C3A4D4D352C58314D473A504A382C5837594E3A4E56312C5838524B3A4739552C584355533A5439572C5846354A3A3031462C58474B523A5641322C584954483A5452462C584D51333A4142372C585939513A5249392C593943483A3231562C5942544A3A42584D2C594D59373A5848592C595054313A5032542C5A3658393A4F59462C5A3959363A5644422C5A444C523A44355A2C5A445A443A5456572C5A45444F3A4E45472C5A4B35553A4458582C5A4C42593A52464A2C5A4C56393A36444C2C5A4D56573A3653422C5A5157563A4C4E482C5A5939353A3638542C5A5949493A53574C2C5A5A49493A4F55532C5A5A544D3A494C572C333531313A5A45532C373432323A4F48512C383937313A5631362C304259443A36355A2C305054583A374C382C305247533A33504A2C30524B323A494C582C30564C463A5448442C30564D503A4E384A2C3135584D3A3730552C314534303A4131462C314D35303A5542532C314D48503A5541522C31525A393A4732382C32314C323A50574F2C323850343A37494D2C323951303A53424F2C324439503A5837412C324741443A3835442C325032443A4D414E2C325232483A494E512C32544A473A5A53512C325857313A4D47302C333935553A4F504A2C334947543A3432572C334E53313A47364E2C33504B4F3A504D422C3352574D3A58304D2C345558303A58434D2C345843483A394B462C353852343A5938442C354656373A36324F2C354831323A3059552C364C45393A5642492C365834413A5835442C3748584B3A5A50542C375152483A51454C2C3834575A3A4756502C3839484B3A4C30572C38554F373A4F4E512C385745373A51354A2C39314D383A3348362C393242573A53594D2C39444B523A4D4D522C39474B363A5938472C413049353A4C4E462C414158513A594A512C414857543A4C43382C414B574C3A4F37512C415033313A4C52522C415352313A5A51552C4236364F3A4D4C332C42555A4F3A584B542C425853383A3257412C433558313A3041572C434D44303A555A482C43534F513A42585A2C435355363A39384E2C435646383A47385A2C4442554F3A4131332C4443314A3A545A502C44434C593A5252442C444832473A5332462C445A56473A4D495A2C453050583A5052502C455352393A4258492C45544C5A3A51514D2C473243553A4A4A562C47434F323A5748502C474741593A32504B2C474F47493A4353562C4755594A3A3650462C483752323A5341382C483958573A5A5A382C484C34503A3054532C484E4E4D3A5441312C484F37353A4A33452C4851434E3A5459462C493053553A4551362C49444A4D3A3955532C494749303A3231492C494B515A3A464B372C495851383A3850472C4A3454413A4544592C4A505A4C3A4B41572C4B34494F3A324C482C4B3530523A50494B2C4B4241453A54304C2C4B435A4D3A395A332C4B54334E3A54584D2C4C334B453A4235462C4C3748303A3735512C4C4E305A3A5253592C4C504B563A4A42422C4C5731553A3335332C4C5A4C4B3A3630432C4D4A36573A5A4B4B2C4D4D434C3A5230382C4D5356483A384D482C4D5437483A5A57432C4E4C584A3A5749302C4E524B373A3443362C4F3258413A4C35382C4F3652453A50495A2C4F4E32513A4743422C4F5A48363A30465A2C50354F443A3933532C503737393A3253372C503854493A5736592C504535393A4B37582C5142424D3A5046332C515758543A4435472C515A4D433A33304A2C52305A4B3A5332482C523756483A3037322C524338503A5254442C524944543A384B362C524A56323A314D342C524F52533A4931552C525633323A4E30512C525635373A33584B2C5259514F3A3946562C53424D4A3A5748302C534445373A4250392C534532513A39564D2C534859573A3436392C534944363A394E342C534E59593A4135492C54434A4F3A5054572C5446434E3A5158352C544A4F363A51524C2C545042423A4A49362C554D4B483A3138582C5551384B3A44354C2C55524D393A3450392C563042343A5130372C5634354B3A4954392C56344A413A5747352C56384B343A3231312C563942443A4731592C564431483A37414B2C5647354E3A3850392C564D48423A4345372C564E53383A4D31372C564F45303A444F372C565137333A41434B2C565842553A4B43522C573334563A3954342C574837533A4330492C575834543A4E54562C583631483A3637522C584B4E463A3935442C585035343A504D562C593038453A3138542C59364D363A4E38482C5947355A3A4154372C594C57483A4633462C594F324C3A4247572C595438483A4B4D502C595537483A5A35352C5A3659463A304F432C5A444C523A44355A2C5A4B444D3A4332472C0000000";
        var expectedCoMo = "CoMo";

        // Act
        var result = parser.ExtractCoMoExpresionsFromResponse(jsonResponse);
        // Assert
        _logger.LogInformation("CoMo Expresions: {0}", JsonSerializer.Serialize(result, new JsonSerializerOptions { WriteIndented = true}));

        Assert.That(result[0], Is.EqualTo(expectedCoMo));
        Assert.That(result[1], Is.EqualTo(expectedCoMo));

    }
}
